<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no"
			name="viewport"
		/>
		<title>Layout &rsaquo; Top Navigation &mdash; Stisla</title>

		<!-- General CSS Files -->
		<link
			rel="stylesheet"
			href="/assets/modules/bootstrap/css/bootstrap.min.css"
		/>
		<link rel="stylesheet" href="/assets/modules/fontawesome/css/all.min.css" />

		<link
			rel="stylesheet"
			href="/assets/modules/izitoast/css/iziToast.min.css"
		/>
		<!-- CSS Libraries -->

		<!-- Template CSS -->
		<link rel="stylesheet" href="/assets/css/style.css" />
		<link rel="stylesheet" href="/assets/css/components.css" />
	</head>

	<body class="layout-3">
		<div id="app">
			<div class="main-wrapper container">
				<!-- Main Content -->
				<div class="main-content" style="padding-top: 80px">
					<section class="section">
						<div class="section-header">
							<h1>Jugo Games</h1>
						</div>

						<form
							action="#"
							class="needs-validation d-flex align-content-center justify-content-center normal"
							novalidate=""
						>
							<div class="form-group">
								<input
									id="namount"
									type="number"
									class="form-control"
									placeholder="Play Amount"
									name="amount"
									tabindex="1"
									required
									autofocus
								/>
								<div class="invalid-feedback">
									Sorry your guess was not right
								</div>
							</div>

							<div class="form-group">
								<button
									type="submit"
									class="btn btn-primary ml-2 btn-lg btn-block"
									tabindex="4"
								>
									Calculate
								</button>
							</div>
						</form>

						<div class="section-body">
							<div class="card">
								<div class="card-header">
									<h4>Game Odds</h4>
								</div>
								<div class="card-body">
									<div class="summary-item">
										<ul class="list-unstyled list-unstyled-border">
											<li class="media">
												<div class="media-body">
													<div class="media-right ml-5">
														<span class="btn btn-outline-primary playthis">
															Play
														</span>
													</div>
													<div class="media-right">
														<span class="text-small text-muted">Winnings</span>
														<span>0</span>
													</div>
													<div class="media-title nodd" value="1.5">
														<a href="#">1.50 ODDS</a>
													</div>
													<div class="text-small text-muted">
														<a href="#">2 Guesses</a>
														<div class="bullet"></div>
														1 hint
													</div>
												</div>
											</li>
											<li class="media">
												<div class="media-body">
													<div class="media-right ml-5">
														<span class="btn btn-outline-primary playthis">
															Play
														</span>
													</div>
													<div class="media-right">
														<span class="text-small text-muted">Winnings</span>
														<span>0</span>
													</div>
													<div class="media-title nodd" value="2.87">
														<a href="#">2.87 ODDS</a>
													</div>
													<div class="text-small text-muted">
														<a href="#">4 Guesses</a>
														<div class="bullet"></div>
														2 hints
													</div>
												</div>
											</li>
											<li class="media">
												<div class="media-body">
													<div class="media-right ml-5">
														<span class="btn btn-outline-primary playthis">
															Play
														</span>
													</div>
													<div class="media-right">
														<span class="text-small text-muted">Winnings</span>
														<span>0</span>
													</div>
													<div class="media-title nodd" value="5.74">
														<a href="#">5.74 ODDS</a>
													</div>
													<div class="text-muted text-small">
														<a href="#">6 Guesses</a>
														<div class="bullet"></div>
														4 hints
													</div>
												</div>
											</li>
											<li class="media">
												<div class="media-body">
													<div class="media-right ml-5">
														<span class="btn btn-outline-primary playthis">
															Play
														</span>
													</div>
													<div class="media-right">
														<span class="text-small text-muted">Winnings</span>
														<span>0</span>
													</div>
													<div class="media-title nodd" value="8.61">
														<a href="#">8.61 ODDS</a>
													</div>
													<div class="text-small text-muted">
														<a href="#">8 Guesses</a>
														<div class="bullet"></div>
														6 hints
													</div>
												</div>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</section>

					<form
						action="#"
						class="needs-validation d-flex align-content-center justify-content-center normal"
						novalidate=""
					>
						<div class="form-group">
							<input
								id="hamount"
								type="number"
								class="form-control"
								placeholder="Play Amount"
								name="amount"
								tabindex="1"
								required
								autofocus
							/>
							<div class="invalid-feedback">Sorry your guess was not right</div>
						</div>

						<div class="form-group">
							<button
								type="submit"
								class="btn btn-primary ml-2 btn-lg btn-block"
								tabindex="4"
							>
								Calculate
							</button>
						</div>
					</form>

					<section class="section">
						<div class="section-body">
							<div class="card">
								<div class="card-header">
									<h4>Game Odds</h4>
								</div>
								<div class="card-body">
									<div class="summary-item">
										<ul class="list-unstyled list-unstyled-border">
											<li class="media">
												<div class="media-body">
													<div class="media-right ml-5">
														<span class="btn btn-outline-primary playthis">
															Play
														</span>
													</div>
													<div class="media-right">
														<span class="text-small text-muted">Winnings</span>
														<span>0</span>
													</div>
													<div class="media-title hodd" value="100">
														<a href="#">100 ODDS</a>
													</div>
													<div class="text-small text-muted">
														<a href="#">2 Guesses</a>
														<div class="bullet"></div>
														1 hint
													</div>
												</div>
											</li>
											<li class="media">
												<div class="media-body">
													<div class="media-right ml-5">
														<span class="btn btn-outline-primary playthis">
															Play
														</span>
													</div>
													<div class="media-right">
														<span class="text-small text-muted">Winnings</span>
														<span>0</span>
													</div>
													<div class="media-title hodd" value="500">
														<a href="#">500 ODDS</a>
													</div>
													<div class="text-small text-muted">
														<a href="#">2 Guesses</a>
														<div class="bullet"></div>
														2 hints
													</div>
												</div>
											</li>
											<li class="media">
												<div class="media-body">
													<div class="media-right ml-5">
														<span class="btn btn-outline-primary playthis">
															Play
														</span>
													</div>
													<div class="media-right">
														<span class="text-small text-muted">Winnings</span>
														<span>0</span>
													</div>
													<div class="media-title hodd" value="1000">
														<a href="#">1000 ODDS</a>
													</div>
													<div class="text-muted text-small">
														<a href="#">2 Guesses</a>
														<div class="bullet"></div>
														4 hints
													</div>
												</div>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</section>
					<a id="aa"></a>
				</div>
				<footer class="main-footer">
					<div class="footer-left">
						Copyright &copy; 2018
						<div class="bullet"></div>
					</div>
					<div class="footer-right"></div>
				</footer>
			</div>
		</div>

		<!-- General JS Scripts -->
		<script src="/assets/modules/jquery.min.js"></script>
		<script src="/assets/modules/popper.js"></script>
		<script src="/assets/modules/tooltip.js"></script>
		<script src="/assets/modules/bootstrap/js/bootstrap.min.js"></script>
		<script src="/assets/modules/nicescroll/jquery.nicescroll.min.js"></script>
		<script src="/assets/modules/moment.min.js"></script>
		<script src="/assets/js/stisla.js"></script>
		<script src="/assets/modules/izitoast/js/iziToast.min.js"></script>

		<!-- JS Libraies -->

		<!-- Page Specific JS File -->

		<!-- Template JS File -->
		<script src="/assets/js/scripts.js"></script>
		<script src="/assets/js/custom.js"></script>
		<script>
			let normalForm = document.querySelectorAll('.normal');
			let playButton = document.querySelectorAll('.playthis');

			let amount = 0;

			const handlePayment = (e) => {
				e.preventDefault();
				amount = e.target.children[0].children[0].value;
				console.log(amount, e.target.children[0].children[0].id);
				if (e.target.children[0].children[0].id == 'namount') {
					document.querySelectorAll('.nodd').forEach((el) => {
						let odd = el.getAttribute('value');
						let res = Number(amount) + Number(amount) * Number(odd);
						el.parentElement.children[1].children[1].innerHTML = `$${res}`;
						// console.log(el.parentElement.children[0].children[1].innerHTML, res);
					});
				}
				if (e.target.children[0].children[0].id == 'hamount') {
					document.querySelectorAll('.hodd').forEach((el) => {
						let odd = el.getAttribute('value');
						let res = Number(amount) + Number(amount) * Number(odd);
						el.parentElement.children[1].children[1].innerHTML = `$${res}`;
						// console.log(el.parentElement.children[0].children[1].innerHTML, res);
					});
				}
			};

			normalForm.forEach((el) => {
				el.addEventListener('submit', handlePayment);
			});

			playButton.forEach((el) => {
				el.addEventListener('click', (e) => {
					let odds =
						e.target.parentElement.parentElement.children[2].getAttribute(
							'value',
						);
					console.log(
						e.target.parentElement.parentElement.children[2].getAttribute(
							'value',
						),
						amount,
					);
					fetch('/game/create', {
						method: 'POST',
						body: JSON.stringify({
							odds: odds,
							vendor: '<%- vendor %>',
							amount: amount,
						}),
						headers: {
							'Content-type': 'application/json; charset=UTF-8',
						},
					})
						.then((res) => res.json())
						.then((res) => {
							if (res.success) {
								document
									.querySelector('#aa')
									.setAttribute('href', `/play/${res.id}`);
								document.querySelector('#aa').click();
							} else {
								iziToast.info({
									title: 'Error',
									message: 'occured while trying to create game',
									position: 'topRight',
								});
							}
						});
				});
			});
		</script>
	</body>
</html>
